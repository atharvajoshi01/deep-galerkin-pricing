# Black-Scholes American Put Option Configuration

experiment_name: "bs_american_put"
seed: 42

# PDE parameters
pde:
  type: "black_scholes_american"
  r: 0.05
  sigma: 0.2
  K: 100.0
  T: 1.0
  option_type: "put"
  S_min: 0.0
  S_max: 200.0
  penalty_lambda: 100.0  # Obstacle penalty coefficient

# Model architecture
model:
  type: "dgm"
  input_dim: 2
  hidden_dim: 64
  output_dim: 1
  num_layers: 4
  activation: "tanh"
  use_spectral_norm: false
  dropout: 0.0

# Training configuration
training:
  epochs: 2000
  n_interior: 3000
  n_boundary: 300
  n_initial: 300

  optimizer: "adam"
  learning_rate: 5e-4
  weight_decay: 1e-5

  lambda_pde: 1.0
  lambda_bc: 1.0
  lambda_ic: 10.0

  use_amp: false
  gradient_clip: 1.0

  use_scheduler: true
  scheduler_type: "cosine"
  warmup_epochs: 100

  early_stopping: true
  patience: 100
  min_delta: 1e-6

# Sampling
sampling:
  method: "sobol"
  use_curriculum: false

# Validation
validation:
  n_points: 1000
  compare_analytical: false  # No closed form for American
  compare_fd: true  # Use finite difference

# Logging
logging:
  log_interval: 10
  save_checkpoints: true
  checkpoint_dir: "checkpoints/bs_american"
  log_dir: "logs/bs_american"

# Evaluation
evaluation:
  S_grid_size: 100
  t_grid_size: 50
  compute_greeks: true
